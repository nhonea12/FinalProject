---
title: "ST 558 Final Project - EDA"
author: "Nathan Honea"
format: html
editor_options: 
  chunk_output_type: console
---

## Introduction 

The following data set contains over 250,000 survey from Americans, with the target variable measuring whether the respondent has diabetes of prediabetes (stored in `Diabetes_binary`). 

There are 21 other variables that can be used to predict which individuals have diabetes/prediabetes. Among these are whether the individual has high blood pressure, and whether the individual has high cholesterol. Other possibly relevant health related variables are whether the individual has had a heart attack or has/had heart disease, whether the individual is a heavy drinker, whether the individual eats fruits and vegetables, whether the individual has been physically active in the last 30 days, whether the individual is/was a smoker, and the individual's BMI. The individuals' general health was also measured by asking them their general health on a five-level scale from "poor" to "excellent". The individuals' sex and age (age being grouped into age brackets) were also collected. The individual's household income bracket was also recorded.

## Data

```{r}
library(tidyverse)

# read in data on diabetes
diabetes_data <- read_csv("diabetes_binary_health_indicators_BRFSS2015.csv")

# view the data and its structure after initially reading in
diabetes_data
str(diabetes_data)

# convert columns with binary variables to factors and change the names of values
diabetes_data <- diabetes_data |> 
  mutate(
    Diabetes_binary = as.factor(Diabetes_binary), 
    HighBP = as.factor(HighBP), 
    HighChol = as.factor(HighChol), 
    CholCheck = as.factor(CholCheck), 
    Smoker = as.factor(Smoker), 
    Stroke = as.factor(Stroke), 
    HeartDiseaseorAttack = as.factor(HeartDiseaseorAttack), 
    PhysActivity = as.factor(PhysActivity), 
    Fruits = as.factor(Fruits), 
    Veggies = as.factor(Veggies), 
    HvyAlcoholConsump = as.factor(HvyAlcoholConsump), 
    AnyHealthcare = as.factor(AnyHealthcare), 
    NoDocbcCost = as.factor(NoDocbcCost), 
    GenHlth = as.factor(GenHlth), 
    DiffWalk = as.factor(DiffWalk), 
    Sex = as.factor(Sex), 
    Age = as.factor(Age), 
    Education = as.factor(Education), 
    Income = as.factor(Income)
  )


# change level names of factors
levels(diabetes_data$Diabetes_binary) <- list("No Diabetes" = "0", "Prediabetes/Diabetes" = "1")

levels(diabetes_data$HighBP) <- list("No High Blood Pressue" = "0", "High Blood Pressure" = "1")

levels(diabetes_data$HighChol) <- list("No High Cholesterol" = "0", "High Cholesterol" = "1")

levels(diabetes_data$CholCheck) <- list("No Chol. check in last 5 years" = "0", "Chol. check in last 5 years" = "1")

levels(diabetes_data$Smoker) <- list("Non-Smoker" = "0", "Smoker" = "1")

levels(diabetes_data$Stroke) <- list("Never had strok" = "0", "Had stroke" = "1")

levels(diabetes_data$HeartDiseaseorAttack) <- list("Never had heart disease/attack" = "0", "Had heart disease/attack" = "1")

levels(diabetes_data$PhysActivity) <- list("No physical activity in last 30 days" = "0", "Physical activity in last 30 days" = "1")

levels(diabetes_data$Fruits) <- list("Doesn't eat fruit" = "0", "Eats fruit" = "1")

levels(diabetes_data$Veggies) <- list("Doesn't eat veggies" = "0", "Eats veggies" = "1")

levels(diabetes_data$HvyAlcoholConsump) <- list("Not heavy drinker" = "0", "Heavy drinker" = "1")

levels(diabetes_data$AnyHealthcare) <- list("No healthcare" = "0", "Healthcare" = "1")

levels(diabetes_data$NoDocbcCost) <- list("Can't afford doctor" = "0", "Can afford doctor" = "1")

levels(diabetes_data$GenHlth) <- list("Excellent" = "1", "Very Good" = "2", "Good" = "3", "Fair" = "4", "Poor" = "5")

levels(diabetes_data$DiffWalk) <- list("No difficulty walking" = "0", "Difficulty walking" = "1")

levels(diabetes_data$Sex) <- list("Female" = "0", "Male" = "1")

levels(diabetes_data$Age) <- list("18-24" = "1", "25-29" = "2", "30-34" = "3", "35-39" = "4", "40-44" = "5", "45-49" = "6", "50-54" = "7", "55-59" = "8", "60-64" = "9", "65-69" = "10", "70-74" = "11", "75-79" = "12", "80+" = "13")

levels(diabetes_data$Education) <- list("No school/kindergarten" = "1", "Elementary" = "2", "Some high school" = "3", "High school graduate" = "4", "Some college" = "5", "College graduate" = "6")

levels(diabetes_data$Income) <- list("< $10,000" = "1", "$10,000-$15,000" = "2", "$15,000-$20,000" = "3", "$20,000-$25,000" = "4", "$25,000-$35,000" = "5", "$35,000-$50,000" = "6", "$50,000-$75,000" = "7", "$75,000+" = "8")

# reexamine the data after changing variables to factors and renaming the levels of the factors
diabetes_data
str(diabetes_data)

# check for missing values
colSums(is.na(diabetes_data))
```

Our variables have been converted to factors with appropriate level names, and our date has no missing values! We are ready to to conduct exploratory data analysis on our data through numeric summaries, tables, and visualizations.

## Summarizations

```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and whether they have high blood pressure
table(diabetes_data$Diabetes_binary, diabetes_data$HighBP)
```

It appears that those with high blood pressure are more likely to have diabetes or prediabetes than those who do not.

```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and whether they have high cholesterol
table(diabetes_data$Diabetes_binary, diabetes_data$HighChol)
```

It appears that those with high cholesterol are more likely to have diabetes or prediabetes than those who do not.

```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and whether they are a smoker
table(diabetes_data$Diabetes_binary, diabetes_data$Smoker)
```

It appears that those who are or were smokers are more likely to have diabetes or prediabetes than those who are/were not.

```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and whether regularly eat vegetables
table(diabetes_data$Diabetes_binary, diabetes_data$Veggies)

# proportion of non-veggie eaters with diabetes
8610/(8610+39229)

# proportion of veggie eaters with diabetes
26736/(26736+179105)
```

It appears that those who regularly eat vegetables are less likely to have diabetes or prediabetes than those who do not.

```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and whether they have had heart disease/attack
table(diabetes_data$Diabetes_binary, diabetes_data$HeartDiseaseorAttack)
```

It appears that those who have had heart disease or a heart attack are much more likely to have diabetes or prediabetes than those who do not.

```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and whether they have high cholesterol
table(diabetes_data$Diabetes_binary, diabetes_data$HvyAlcoholConsump)

# proportion of non-heavy drinkers with diabetes
34514/(34514+204910)

# proportion of heavy drinkers with diabetes
832/(832+13424)
```

It appears that heavy drinkers are actually less likely to have diabetes or prediabetes than those who are not heavy drinkers. 


```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and whether they have been physically active in the last 30 days
table(diabetes_data$Diabetes_binary, diabetes_data$PhysActivity)
```

It appears that those who have not exercised in the last 30 days are more likely to have diabetes or prediabetes than those who have.

```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and their self-reported general health level
table(diabetes_data$Diabetes_binary, diabetes_data$GenHlth)
```

The most common response respondents gave for their general health was 'Very Good', followed by 'Good'. It appears that the better someone reports their general health, the less likely they are to have diabetes. This makes sense, considering having diabetes/prediabetes would adversely affect your general health.

```{r}
# two-way contingency table of whether someone has diabetes/prediabetes and their household income
table(diabetes_data$Diabetes_binary, diabetes_data$Income)
```

It generally appears that those with a higher household income are less likely to have diabetes or prediabetes, with over ten times as many non-diabetics in the uppermost income level compared to the lowermost, but only about three times as many diabetics/prediabetics.


[Click here for the Modeling Page](Modeling.html)