[
  {
    "objectID": "EDA.html#data",
    "href": "EDA.html#data",
    "title": "ST 558 Final Project - EDA",
    "section": "Data",
    "text": "Data\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n# read in data on diabetes\ndiabetes_data &lt;- read_csv(\"diabetes_binary_health_indicators_BRFSS2015.csv\")\n\nRows: 253680 Columns: 22\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (22): Diabetes_binary, HighBP, HighChol, CholCheck, BMI, Smoker, Stroke,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n# view the data and its structure after initially reading in\ndiabetes_data\n\n# A tibble: 253,680 × 22\n   Diabetes_binary HighBP HighChol CholCheck   BMI Smoker Stroke\n             &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1               0      1        1         1    40      1      0\n 2               0      0        0         0    25      1      0\n 3               0      1        1         1    28      0      0\n 4               0      1        0         1    27      0      0\n 5               0      1        1         1    24      0      0\n 6               0      1        1         1    25      1      0\n 7               0      1        0         1    30      1      0\n 8               0      1        1         1    25      1      0\n 9               1      1        1         1    30      1      0\n10               0      0        0         1    24      0      0\n# ℹ 253,670 more rows\n# ℹ 15 more variables: HeartDiseaseorAttack &lt;dbl&gt;, PhysActivity &lt;dbl&gt;,\n#   Fruits &lt;dbl&gt;, Veggies &lt;dbl&gt;, HvyAlcoholConsump &lt;dbl&gt;, AnyHealthcare &lt;dbl&gt;,\n#   NoDocbcCost &lt;dbl&gt;, GenHlth &lt;dbl&gt;, MentHlth &lt;dbl&gt;, PhysHlth &lt;dbl&gt;,\n#   DiffWalk &lt;dbl&gt;, Sex &lt;dbl&gt;, Age &lt;dbl&gt;, Education &lt;dbl&gt;, Income &lt;dbl&gt;\n\nstr(diabetes_data)\n\nspc_tbl_ [253,680 × 22] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Diabetes_binary     : num [1:253680] 0 0 0 0 0 0 0 0 1 0 ...\n $ HighBP              : num [1:253680] 1 0 1 1 1 1 1 1 1 0 ...\n $ HighChol            : num [1:253680] 1 0 1 0 1 1 0 1 1 0 ...\n $ CholCheck           : num [1:253680] 1 0 1 1 1 1 1 1 1 1 ...\n $ BMI                 : num [1:253680] 40 25 28 27 24 25 30 25 30 24 ...\n $ Smoker              : num [1:253680] 1 1 0 0 0 1 1 1 1 0 ...\n $ Stroke              : num [1:253680] 0 0 0 0 0 0 0 0 0 0 ...\n $ HeartDiseaseorAttack: num [1:253680] 0 0 0 0 0 0 0 0 1 0 ...\n $ PhysActivity        : num [1:253680] 0 1 0 1 1 1 0 1 0 0 ...\n $ Fruits              : num [1:253680] 0 0 1 1 1 1 0 0 1 0 ...\n $ Veggies             : num [1:253680] 1 0 0 1 1 1 0 1 1 1 ...\n $ HvyAlcoholConsump   : num [1:253680] 0 0 0 0 0 0 0 0 0 0 ...\n $ AnyHealthcare       : num [1:253680] 1 0 1 1 1 1 1 1 1 1 ...\n $ NoDocbcCost         : num [1:253680] 0 1 1 0 0 0 0 0 0 0 ...\n $ GenHlth             : num [1:253680] 5 3 5 2 2 2 3 3 5 2 ...\n $ MentHlth            : num [1:253680] 18 0 30 0 3 0 0 0 30 0 ...\n $ PhysHlth            : num [1:253680] 15 0 30 0 0 2 14 0 30 0 ...\n $ DiffWalk            : num [1:253680] 1 0 1 0 0 0 0 1 1 0 ...\n $ Sex                 : num [1:253680] 0 0 0 0 0 1 0 0 0 1 ...\n $ Age                 : num [1:253680] 9 7 9 11 11 10 9 11 9 8 ...\n $ Education           : num [1:253680] 4 6 4 3 5 6 6 4 5 4 ...\n $ Income              : num [1:253680] 3 1 8 6 4 8 7 4 1 3 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Diabetes_binary = col_double(),\n  ..   HighBP = col_double(),\n  ..   HighChol = col_double(),\n  ..   CholCheck = col_double(),\n  ..   BMI = col_double(),\n  ..   Smoker = col_double(),\n  ..   Stroke = col_double(),\n  ..   HeartDiseaseorAttack = col_double(),\n  ..   PhysActivity = col_double(),\n  ..   Fruits = col_double(),\n  ..   Veggies = col_double(),\n  ..   HvyAlcoholConsump = col_double(),\n  ..   AnyHealthcare = col_double(),\n  ..   NoDocbcCost = col_double(),\n  ..   GenHlth = col_double(),\n  ..   MentHlth = col_double(),\n  ..   PhysHlth = col_double(),\n  ..   DiffWalk = col_double(),\n  ..   Sex = col_double(),\n  ..   Age = col_double(),\n  ..   Education = col_double(),\n  ..   Income = col_double()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt; \n\n# convert columns with binary variables to factors and change the names of values\ndiabetes_data &lt;- diabetes_data |&gt; \n  mutate(\n    Diabetes_binary = as.factor(Diabetes_binary), \n    HighBP = as.factor(HighBP), \n    HighChol = as.factor(HighChol), \n    CholCheck = as.factor(CholCheck), \n    Smoker = as.factor(Smoker), \n    Stroke = as.factor(Stroke), \n    HeartDiseaseorAttack = as.factor(HeartDiseaseorAttack), \n    PhysActivity = as.factor(PhysActivity), \n    Fruits = as.factor(Fruits), \n    Veggies = as.factor(Veggies), \n    HvyAlcoholConsump = as.factor(HvyAlcoholConsump), \n    AnyHealthcare = as.factor(AnyHealthcare), \n    NoDocbcCost = as.factor(NoDocbcCost), \n    GenHlth = as.factor(GenHlth), \n    DiffWalk = as.factor(DiffWalk), \n    Sex = as.factor(Sex), \n    Age = as.factor(Age), \n    Education = as.factor(Education), \n    Income = as.factor(Income)\n  )\n\n\n# change level names of factors\nlevels(diabetes_data$Diabetes_binary) &lt;- list(\"No Diabetes\" = \"0\", \"Prediabetes/Diabetes\" = \"1\")\n\nlevels(diabetes_data$HighBP) &lt;- list(\"No High Blood Pressue\" = \"0\", \"High Blood Pressure\" = \"1\")\n\nlevels(diabetes_data$HighChol) &lt;- list(\"No High Cholesterol\" = \"0\", \"High Cholesterol\" = \"1\")\n\nlevels(diabetes_data$CholCheck) &lt;- list(\"No Chol. check in last 5 years\" = \"0\", \"Chol. check in last 5 years\" = \"1\")\n\nlevels(diabetes_data$Smoker) &lt;- list(\"Non-Smoker\" = \"0\", \"Smoker\" = \"1\")\n\nlevels(diabetes_data$Stroke) &lt;- list(\"Never had strok\" = \"0\", \"Had stroke\" = \"1\")\n\nlevels(diabetes_data$HeartDiseaseorAttack) &lt;- list(\"Never had heart disease/attack\" = \"0\", \"Had heart disease/attack\" = \"1\")\n\nlevels(diabetes_data$PhysActivity) &lt;- list(\"No physical activity in last 30 days\" = \"0\", \"Physical activity in last 30 days\" = \"1\")\n\nlevels(diabetes_data$Fruits) &lt;- list(\"Doesn't eat fruit\" = \"0\", \"Eats fruit\" = \"1\")\n\nlevels(diabetes_data$Veggies) &lt;- list(\"Doesn't eat veggies\" = \"0\", \"Eats veggies\" = \"1\")\n\nlevels(diabetes_data$HvyAlcoholConsump) &lt;- list(\"Not heavy drinker\" = \"0\", \"Heavy drinker\" = \"1\")\n\nlevels(diabetes_data$AnyHealthcare) &lt;- list(\"No healthcare\" = \"0\", \"Healthcare\" = \"1\")\n\nlevels(diabetes_data$NoDocbcCost) &lt;- list(\"Can't afford doctor\" = \"0\", \"Can afford doctor\" = \"1\")\n\nlevels(diabetes_data$GenHlth) &lt;- list(\"Excellent\" = \"1\", \"Very Good\" = \"2\", \"Good\" = \"3\", \"Fair\" = \"4\", \"Poor\" = \"5\")\n\nlevels(diabetes_data$DiffWalk) &lt;- list(\"No difficulty walking\" = \"0\", \"Difficulty walking\" = \"1\")\n\nlevels(diabetes_data$Sex) &lt;- list(\"Female\" = \"0\", \"Male\" = \"1\")\n\nlevels(diabetes_data$Age) &lt;- list(\"18-24\" = \"1\", \"25-29\" = \"2\", \"30-34\" = \"3\", \"35-39\" = \"4\", \"40-44\" = \"5\", \"45-49\" = \"6\", \"50-54\" = \"7\", \"55-59\" = \"8\", \"60-64\" = \"9\", \"65-69\" = \"10\", \"70-74\" = \"11\", \"75-79\" = \"12\", \"80+\" = \"13\")\n\nlevels(diabetes_data$Education) &lt;- list(\"No school/kindergarten\" = \"1\", \"Elementary\" = \"2\", \"Some high school\" = \"3\", \"High school graduate\" = \"4\", \"Some college\" = \"5\", \"College graduate\" = \"6\")\n\nlevels(diabetes_data$Income) &lt;- list(\"&lt; $10,000\" = \"1\", \"$10,000-$15,000\" = \"2\", \"$15,000-$20,000\" = \"3\", \"$20,000-$25,000\" = \"4\", \"$25,000-$35,000\" = \"5\", \"$35,000-$50,000\" = \"6\", \"$50,000-$75,000\" = \"7\", \"$75,000+\" = \"8\")\n\n# reexamine the data after changing variables to factors and renaming the levels of the factors\ndiabetes_data\n\n# A tibble: 253,680 × 22\n   Diabetes_binary      HighBP            HighChol CholCheck   BMI Smoker Stroke\n   &lt;fct&gt;                &lt;fct&gt;             &lt;fct&gt;    &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt; \n 1 No Diabetes          High Blood Press… High Ch… Chol. ch…    40 Smoker Never…\n 2 No Diabetes          No High Blood Pr… No High… No Chol.…    25 Smoker Never…\n 3 No Diabetes          High Blood Press… High Ch… Chol. ch…    28 Non-S… Never…\n 4 No Diabetes          High Blood Press… No High… Chol. ch…    27 Non-S… Never…\n 5 No Diabetes          High Blood Press… High Ch… Chol. ch…    24 Non-S… Never…\n 6 No Diabetes          High Blood Press… High Ch… Chol. ch…    25 Smoker Never…\n 7 No Diabetes          High Blood Press… No High… Chol. ch…    30 Smoker Never…\n 8 No Diabetes          High Blood Press… High Ch… Chol. ch…    25 Smoker Never…\n 9 Prediabetes/Diabetes High Blood Press… High Ch… Chol. ch…    30 Smoker Never…\n10 No Diabetes          No High Blood Pr… No High… Chol. ch…    24 Non-S… Never…\n# ℹ 253,670 more rows\n# ℹ 15 more variables: HeartDiseaseorAttack &lt;fct&gt;, PhysActivity &lt;fct&gt;,\n#   Fruits &lt;fct&gt;, Veggies &lt;fct&gt;, HvyAlcoholConsump &lt;fct&gt;, AnyHealthcare &lt;fct&gt;,\n#   NoDocbcCost &lt;fct&gt;, GenHlth &lt;fct&gt;, MentHlth &lt;dbl&gt;, PhysHlth &lt;dbl&gt;,\n#   DiffWalk &lt;fct&gt;, Sex &lt;fct&gt;, Age &lt;fct&gt;, Education &lt;fct&gt;, Income &lt;fct&gt;\n\nstr(diabetes_data)\n\ntibble [253,680 × 22] (S3: tbl_df/tbl/data.frame)\n $ Diabetes_binary     : Factor w/ 2 levels \"No Diabetes\",..: 1 1 1 1 1 1 1 1 2 1 ...\n $ HighBP              : Factor w/ 2 levels \"No High Blood Pressue\",..: 2 1 2 2 2 2 2 2 2 1 ...\n $ HighChol            : Factor w/ 2 levels \"No High Cholesterol\",..: 2 1 2 1 2 2 1 2 2 1 ...\n $ CholCheck           : Factor w/ 2 levels \"No Chol. check in last 5 years\",..: 2 1 2 2 2 2 2 2 2 2 ...\n $ BMI                 : num [1:253680] 40 25 28 27 24 25 30 25 30 24 ...\n $ Smoker              : Factor w/ 2 levels \"Non-Smoker\",\"Smoker\": 2 2 1 1 1 2 2 2 2 1 ...\n $ Stroke              : Factor w/ 2 levels \"Never had strok\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ HeartDiseaseorAttack: Factor w/ 2 levels \"Never had heart disease/attack\",..: 1 1 1 1 1 1 1 1 2 1 ...\n $ PhysActivity        : Factor w/ 2 levels \"No physical activity in last 30 days\",..: 1 2 1 2 2 2 1 2 1 1 ...\n $ Fruits              : Factor w/ 2 levels \"Doesn't eat fruit\",..: 1 1 2 2 2 2 1 1 2 1 ...\n $ Veggies             : Factor w/ 2 levels \"Doesn't eat veggies\",..: 2 1 1 2 2 2 1 2 2 2 ...\n $ HvyAlcoholConsump   : Factor w/ 2 levels \"Not heavy drinker\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ AnyHealthcare       : Factor w/ 2 levels \"No healthcare\",..: 2 1 2 2 2 2 2 2 2 2 ...\n $ NoDocbcCost         : Factor w/ 2 levels \"Can't afford doctor\",..: 1 2 2 1 1 1 1 1 1 1 ...\n $ GenHlth             : Factor w/ 5 levels \"Excellent\",\"Very Good\",..: 5 3 5 2 2 2 3 3 5 2 ...\n $ MentHlth            : num [1:253680] 18 0 30 0 3 0 0 0 30 0 ...\n $ PhysHlth            : num [1:253680] 15 0 30 0 0 2 14 0 30 0 ...\n $ DiffWalk            : Factor w/ 2 levels \"No difficulty walking\",..: 2 1 2 1 1 1 1 2 2 1 ...\n $ Sex                 : Factor w/ 2 levels \"Female\",\"Male\": 1 1 1 1 1 2 1 1 1 2 ...\n $ Age                 : Factor w/ 13 levels \"18-24\",\"25-29\",..: 9 7 9 11 11 10 9 11 9 8 ...\n $ Education           : Factor w/ 6 levels \"No school/kindergarten\",..: 4 6 4 3 5 6 6 4 5 4 ...\n $ Income              : Factor w/ 8 levels \"&lt; $10,000\",\"$10,000-$15,000\",..: 3 1 8 6 4 8 7 4 1 3 ...\n\n# check for missing values\ncolSums(is.na(diabetes_data))\n\n     Diabetes_binary               HighBP             HighChol \n                   0                    0                    0 \n           CholCheck                  BMI               Smoker \n                   0                    0                    0 \n              Stroke HeartDiseaseorAttack         PhysActivity \n                   0                    0                    0 \n              Fruits              Veggies    HvyAlcoholConsump \n                   0                    0                    0 \n       AnyHealthcare          NoDocbcCost              GenHlth \n                   0                    0                    0 \n            MentHlth             PhysHlth             DiffWalk \n                   0                    0                    0 \n                 Sex                  Age            Education \n                   0                    0                    0 \n              Income \n                   0 \n\n\nOur variables have been converted to factors with appropriate level names, and our date has no missing values! We are ready to to conduct exploratory data analysis on our data through numeric summaries, tables, and visualizations."
  },
  {
    "objectID": "EDA.html#summarizations",
    "href": "EDA.html#summarizations",
    "title": "ST 558 Final Project - EDA",
    "section": "Summarizations",
    "text": "Summarizations\n\nTwo-Way Contingency Tables\n\n# two-way contingency table of whether someone has diabetes/prediabetes and whether they have high blood pressure\ntable(diabetes_data$Diabetes_binary, diabetes_data$HighBP)\n\n                      \n                       No High Blood Pressue High Blood Pressure\n  No Diabetes                         136109               82225\n  Prediabetes/Diabetes                  8742               26604\n\n\nIt appears that those with high blood pressure are more likely to have diabetes or prediabetes than those who do not.\n\n# two-way contingency table of whether someone has diabetes/prediabetes and whether they have high cholesterol\ntable(diabetes_data$Diabetes_binary, diabetes_data$HighChol)\n\n                      \n                       No High Cholesterol High Cholesterol\n  No Diabetes                       134429            83905\n  Prediabetes/Diabetes               11660            23686\n\n\nIt appears that those with high cholesterol are more likely to have diabetes or prediabetes than those who do not.\n\n# two-way contingency table of whether someone has diabetes/prediabetes and whether they are a smoker\ntable(diabetes_data$Diabetes_binary, diabetes_data$Smoker)\n\n                      \n                       Non-Smoker Smoker\n  No Diabetes              124228  94106\n  Prediabetes/Diabetes      17029  18317\n\n\nIt appears that those who are or were smokers are more likely to have diabetes or prediabetes than those who are/were not.\n\n# two-way contingency table of whether someone has diabetes/prediabetes and whether regularly eat vegetables\ntable(diabetes_data$Diabetes_binary, diabetes_data$Veggies)\n\n                      \n                       Doesn't eat veggies Eats veggies\n  No Diabetes                        39229       179105\n  Prediabetes/Diabetes                8610        26736\n\n# proportion of non-veggie eaters with diabetes\n8610/(8610+39229)\n\n[1] 0.1799787\n\n# proportion of veggie eaters with diabetes\n26736/(26736+179105)\n\n[1] 0.1298867\n\n\nIt appears that those who regularly eat vegetables are less likely to have diabetes or prediabetes than those who do not.\n\n# two-way contingency table of whether someone has diabetes/prediabetes and whether they have had heart disease/attack\ntable(diabetes_data$Diabetes_binary, diabetes_data$HeartDiseaseorAttack)\n\n                      \n                       Never had heart disease/attack Had heart disease/attack\n  No Diabetes                                  202319                    16015\n  Prediabetes/Diabetes                          27468                     7878\n\n\nIt appears that those who have had heart disease or a heart attack are much more likely to have diabetes or prediabetes than those who do not.\n\n# two-way contingency table of whether someone has diabetes/prediabetes and whether they have high cholesterol\ntable(diabetes_data$Diabetes_binary, diabetes_data$HvyAlcoholConsump)\n\n                      \n                       Not heavy drinker Heavy drinker\n  No Diabetes                     204910         13424\n  Prediabetes/Diabetes             34514           832\n\n# proportion of non-heavy drinkers with diabetes\n34514/(34514+204910)\n\n[1] 0.1441543\n\n# proportion of heavy drinkers with diabetes\n832/(832+13424)\n\n[1] 0.05836139\n\n\nIt appears that heavy drinkers are actually less likely to have diabetes or prediabetes than those who are not heavy drinkers.\n\n# two-way contingency table of whether someone has diabetes/prediabetes and whether they have been physically active in the last 30 days\ntable(diabetes_data$Diabetes_binary, diabetes_data$PhysActivity)\n\n                      \n                       No physical activity in last 30 days\n  No Diabetes                                         48701\n  Prediabetes/Diabetes                                13059\n                      \n                       Physical activity in last 30 days\n  No Diabetes                                     169633\n  Prediabetes/Diabetes                             22287\n\n\nIt appears that those who have not exercised in the last 30 days are more likely to have diabetes or prediabetes than those who have.\n\n# two-way contingency table of whether someone has diabetes/prediabetes and their self-reported general health level\ntable(diabetes_data$Diabetes_binary, diabetes_data$GenHlth)\n\n                      \n                       Excellent Very Good  Good  Fair  Poor\n  No Diabetes              44159     82703 62189 21780  7503\n  Prediabetes/Diabetes      1140      6381 13457  9790  4578\n\n\nThe most common response respondents gave for their general health was ‘Very Good’, followed by ‘Good’. It appears that the better someone reports their general health, the less likely they are to have diabetes. This makes sense, considering having diabetes/prediabetes would adversely affect your general health.\n\n# two-way contingency table of whether someone has diabetes/prediabetes and their household income\ntable(diabetes_data$Diabetes_binary, diabetes_data$Income)\n\n                      \n                       &lt; $10,000 $10,000-$15,000 $15,000-$20,000\n  No Diabetes               7428            8697           12426\n  Prediabetes/Diabetes      2383            3086            3568\n                      \n                       $20,000-$25,000 $25,000-$35,000 $35,000-$50,000\n  No Diabetes                    16081           21379           31179\n  Prediabetes/Diabetes            4054            4504            5291\n                      \n                       $50,000-$75,000 $75,000+\n  No Diabetes                    37954    83190\n  Prediabetes/Diabetes            5265     7195\n\n\nIt generally appears that those with a higher household income are less likely to have diabetes or prediabetes, with over ten times as many non-diabetics in the uppermost income level compared to the lowermost, but only about three times as many diabetics/prediabetics.\n\n\nGrouped Means and Standard Deviations\n\n# report the mean and standard deviation of the BMI's of those who reported having diabetes/prediabetes and those who didn't\ndiabetes_data |&gt; \n  group_by(Diabetes_binary) |&gt; \n  summarize(\n    mean_BMI = mean(BMI),\n    sd_BMI = sd(BMI)\n  )\n\n# A tibble: 2 × 3\n  Diabetes_binary      mean_BMI sd_BMI\n  &lt;fct&gt;                   &lt;dbl&gt;  &lt;dbl&gt;\n1 No Diabetes              27.8   6.29\n2 Prediabetes/Diabetes     31.9   7.36\n\n\nIt appears that individuals who have diabetes or prediabetes tend to have a larger BMI on average, with the mean BMI for diabetics/prediabetics being 4.1 units higher than for non-diabetics.\n\n# report the mean and standard deviation of the BMI's of those who reported having diabetes/prediabetes and those who didn't\ndiabetes_data |&gt; \n  group_by(Diabetes_binary) |&gt; \n  summarize(\n    mean_mental_health = mean(MentHlth),\n    sd_mental_health = sd(MentHlth)\n  )\n\n# A tibble: 2 × 3\n  Diabetes_binary      mean_mental_health sd_mental_health\n  &lt;fct&gt;                             &lt;dbl&gt;            &lt;dbl&gt;\n1 No Diabetes                        2.98             7.11\n2 Prediabetes/Diabetes               4.46             8.95\n\n\nIt appears that individuals who have diabetes or prediabetes tend to have had more poor mental health days in the last 30 days, with the mean number of recent poor mental health days for diabetics/prediabetics being 1.48 days higher than for non-diabetics.\n\n# report the mean and standard deviation of the BMI's of those who reported having diabetes/prediabetes and those who didn't\ndiabetes_data |&gt; \n  group_by(Diabetes_binary) |&gt; \n  summarize(\n    mean_physical_health = mean(PhysHlth),\n    sd_physical_health = sd(PhysHlth)\n  )\n\n# A tibble: 2 × 3\n  Diabetes_binary      mean_physical_health sd_physical_health\n  &lt;fct&gt;                               &lt;dbl&gt;              &lt;dbl&gt;\n1 No Diabetes                          3.64               8.06\n2 Prediabetes/Diabetes                 7.95              11.3 \n\n\nIt appears that individuals who have diabetes or prediabetes tend to have had more poor physical health days in the last 30 days as well, with the mean number of recent poor physical health days for diabetics/prediabetics being 4.31 days higher than for non-diabetics.\n\n\nVisualizations\n\n# plot of mean BMI grouped by diabetes diagnosis\ndiabetes_data |&gt; \n  group_by(Diabetes_binary) |&gt; \n  summarize(\n    mean_BMI = mean(BMI)\n  ) |&gt; \n  ggplot(aes(x = Diabetes_binary, y = mean_BMI)) + \n  geom_col() + \n  labs(\n    x = \"Diabetes Category\",\n    y = \"Mean BMI\",\n    title = \"Mean BMI of those with and without \\n diabetes/prediabetes\"\n  )\n\n\n\n\n\n\n\n\nThe above plot is a visualization of how those with diabetes or prediabetes have a higher mean BMI those who do not have diabetes.\n\n# plot of mean BMI grouped by diabetes diagnosis\ndiabetes_data |&gt; \n  group_by(Diabetes_binary) |&gt; \n  summarize(\n    mean_physical_health = mean(PhysHlth)\n  ) |&gt; \n  ggplot(aes(x = Diabetes_binary, y = mean_physical_health)) + \n  geom_col() + \n  labs(\n    x = \"Diabetes Category\",\n    y = \"Mean Number of Poor Physical Health Days \\n (Last 30 Days)\",\n    title = \"Mean number of poor physical health days for those \\n with and without diabetes/prediabetes\"\n  )\n\n\n\n\n\n\n\n\nThe above plot is a visualization of how those with diabetes or prediabetes have more poor physical healthy days than those who do not have diabetes.\n\n# plot of diabetes vs income level in terms of counts observations\nggplot(data = diabetes_data, aes(x = Income, fill = Diabetes_binary)) + \n  geom_bar() + \n  labs(\n    y = \"Count\",\n    title = \"Diabetes diagnosis grouped by income level\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n\nThis plot shows how a larger proportion of those in lower income brackets have diabetes or prediabetes.\n\n# plot of diabetes vs income level in terms of proportions\nggplot(data = diabetes_data, aes(x = Income, fill = Diabetes_binary)) + \n  geom_bar(position = \"fill\") + \n  labs(\n    y = \"Proportion\",\n    title = \"Diabetes diagnosis grouped by income level\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n\nThis plot shows the same thing as the one before, but shows the proportions instead of counts, making it more clear that those in lower income brackets are more likely to have diabetes or prediabetes.\n\n# plot of diabetes vs high blood pressure in terms of counts/observations\nggplot(data = diabetes_data, aes(x = HighBP, fill = Diabetes_binary)) + \n  geom_bar() + \n  labs(\n    x = \"High Blood Pressure?\",\n    y = \"Count\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n has high blood pressure\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n# plot of diabetes vs high blood pressure in terms of proportions\nggplot(data = diabetes_data, aes(x = HighBP, fill = Diabetes_binary)) + \n  geom_bar(position = \"fill\") + \n  labs(\n    x = \"High Blood Pressure?\",\n    y = \"Proportion\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n has high blood pressure\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n\nThe above plots show how those with high blood pressure are more likely to have diabetes or prediabetes than those without high blood pressure. The first plot shows the counts and the second shows the proportions.\n\n# plot of diabetes vs high cholesterol in terms of counts/observations\nggplot(data = diabetes_data, aes(x = HighChol, fill = Diabetes_binary)) + \n  geom_bar() + \n  labs(\n    x = \"High Cholesterol?\",\n    y = \"Count\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n has high cholesterol\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n# plot of diabetes vs high cholesterol in terms of proportions\nggplot(data = diabetes_data, aes(x = HighChol, fill = Diabetes_binary)) + \n  geom_bar(position = \"fill\") + \n  labs(\n    x = \"High Cholesterol?\",\n    y = \"Proportion\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n has high cholesterol\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n\nThe above plots show how those with high cholesterol are more likely to have diabetes or prediabetes than those without high cholesterol. The first plot shows the counts and the second shows the proportions.\n\n# plot of diabetes vs general health in terms of counts/observations\nggplot(data = diabetes_data, aes(x = GenHlth, fill = Diabetes_binary)) + \n  geom_bar() + \n  labs(\n    x = \"General Health\",\n    y = \"Count\",\n    title = \"Diabetes diagnosis grouped by individuals' \\n self-reported general health\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n# plot of diabetes vs general health in terms of proportions\nggplot(data = diabetes_data, aes(x = GenHlth, fill = Diabetes_binary)) + \n  geom_bar(position = \"fill\") + \n  labs(\n    x = \"General Health\",\n    y = \"Proportion\",\n    title = \"Diabetes diagnosis grouped by individuals' \\n self-reported general health\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n\nThe above plots show how those who report worse general health are more likely to have diabetes or prediabetes than those who report better general health. The first plot shows the counts and the second shows the proportions.\n\n# plot of diabetes vs heart disease/attack in terms of counts/observations\nggplot(data = diabetes_data, aes(x = HeartDiseaseorAttack, fill = Diabetes_binary)) + \n  geom_bar() + \n  labs(\n    x = \"Heart Disease/Attack?\",\n    y = \"Count\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n has had heart disease or a heart attack\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n# plot of diabetes vs heart disease/attack in terms of proportions\nggplot(data = diabetes_data, aes(x = HeartDiseaseorAttack, fill = Diabetes_binary)) + \n  geom_bar(position = \"fill\") + \n  labs(\n    x = \"Heart Disease/Attack?\",\n    y = \"Proportion\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n has had heart disease or a heart attack\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n\nThe above plots show how those who have had heart disease or a heart attack are more likely to have diabetes or prediabetes than those who have not. The first plot shows the counts and the second shows the proportions.\n\n# plot of diabetes vs smoker in terms of counts/observations\nggplot(data = diabetes_data, aes(x = Smoker, fill = Diabetes_binary)) + \n  geom_bar() + \n  labs(\n    x = \"Smoker?\",\n    y = \"Count\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n is or was a smoker\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n# plot of diabetes vs smoker in terms of proportions\nggplot(data = diabetes_data, aes(x = Smoker, fill = Diabetes_binary)) + \n  geom_bar(position = \"fill\") + \n  labs(\n    x = \"Smoker?\",\n    y = \"Proportion\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n is or was a smoker\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n\nThe above plots show how those who are or were smokers are more slightly likely to have diabetes or prediabetes than those who have never been smokers. Being a smoker is defined as having at least 100 cigarettes in your life. The first plot shows the counts and the second shows the proportions. While the proportion is higher among smokers, the difference is less stark than some of the other indicator variables.\n\n# plot of diabetes vs veggies in terms of counts/observations\nggplot(data = diabetes_data, aes(x = Veggies, fill = Diabetes_binary)) + \n  geom_bar() + \n  labs(\n    x = \"Eats Vegetables?\",\n    y = \"Count\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n regularly eats vegetables\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n# plot of diabetes vs veggies in terms of proportions\nggplot(data = diabetes_data, aes(x = Veggies, fill = Diabetes_binary)) + \n  geom_bar(position = \"fill\") + \n  labs(\n    x = \"Eats Vegetables?\",\n    y = \"Proportion\",\n    title = \"Diabetes diagnosis grouped by whether individual \\n regularly eats vegetables\"\n  ) + \n  scale_fill_discrete(name = \"Diabetes Category:\")\n\n\n\n\n\n\n\n\nThe above plots show how those who do not regularly eat vegetables are more likely to have diabetes or prediabetes than those who do. The first plot shows the counts and the second shows the proportions.\nClick here for the Modeling Page"
  },
  {
    "objectID": "Modeling.html#random-forest-model",
    "href": "Modeling.html#random-forest-model",
    "title": "ST 558 Final Project - Modeling",
    "section": "Random Forest Model",
    "text": "Random Forest Model\nThe random forest model is another form of a tree model, as we will once again be splitting our data into regions, and classifying our response based on those regions. However, unlike a normal classification tree, the random forest uses bootstrapping to get multiple samples fit and average across multiple trees, thus reducing the variance. While this is also done in a bagged tree model, random forests differ from normal bagged tree models by not including every predictor in every level of splitting, only a random subset of the predictors, so that if their is a strong predictor that is always used early in the splitting of a tree under normal bagging circumstance, under bagging it will not always be used first, reducing the correlation between our trees, thus reducing our variance. So with bagging, one or two predictors won’t dominate all of our trees we are averaging over.\n\n# set up our model type and engine for our random forest model, tune on number of parameters to split on\nrf_spec &lt;- rand_forest(mtry = tune()) |&gt;\n  set_engine(\"ranger\") |&gt;\n  set_mode(\"classification\")\n\n# create the workflow for our random forest model\nrf_wkf &lt;- workflow() |&gt;\n  add_recipe(recipe) |&gt;\n  add_model(rf_spec)\n\n# fit our random forest models\nrf_fit &lt;- rf_wkf |&gt;\n  tune_grid(\n    resamples = diabetes_5_fold_cv,\n    grid = 5,\n    metrics = metric_set(mn_log_loss)\n    )\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n# view which of our random forest models work best based on log loss\nrf_fit |&gt;\n  collect_metrics() |&gt;\n  filter(.metric == \"mn_log_loss\") |&gt;\n  arrange(mean)\n\n# A tibble: 5 × 7\n   mtry .metric     .estimator  mean     n std_err .config        \n  &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          \n1     3 mn_log_loss binary     0.327     5 0.00185 pre0_mod2_post0\n2     5 mn_log_loss binary     0.327     5 0.00194 pre0_mod3_post0\n3     8 mn_log_loss binary     0.333     5 0.00205 pre0_mod4_post0\n4     1 mn_log_loss binary     0.347     5 0.00184 pre0_mod1_post0\n5    10 mn_log_loss binary     0.371     5 0.00518 pre0_mod5_post0\n\n# save our best tuning parameters\nrf_best_params &lt;- select_best(rf_fit, metric = \"mn_log_loss\")\nrf_best_params\n\n# A tibble: 1 × 2\n   mtry .config        \n  &lt;int&gt; &lt;chr&gt;          \n1     3 pre0_mod2_post0\n\n# update the workflow and fit our best random forest model on the training set\nrf_final_wkf &lt;- rf_wkf |&gt;\n finalize_workflow(rf_best_params)\n\nrf_final_fit &lt;- rf_final_wkf |&gt;\n last_fit(diabetes_split, metrics = metric_set(mn_log_loss))\n\nrf_final_fit\n\n# Resampling results\n# Manual resampling \n# A tibble: 1 × 6\n  splits                 id            .metrics .notes   .predictions .workflow \n  &lt;list&gt;                 &lt;chr&gt;         &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    \n1 &lt;split [177576/76104]&gt; train/test s… &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;\n\n\nWe now have our best random forest model! We can now select the best overall model from the best of each of the model types."
  },
  {
    "objectID": "Modeling.html#final-model-selection",
    "href": "Modeling.html#final-model-selection",
    "title": "ST 558 Final Project - Modeling",
    "section": "Final Model Selection",
    "text": "Final Model Selection\n\nset.seed(2824)\n# compare metrics of each of the final models above\nrbind(\n # regression tree\n class_tree_final_fit |&gt; \n   collect_metrics() |&gt; \n   mutate(Model = \"CLASS TREE\", .before = \".metric\"),\n # random forest\n rf_final_fit |&gt; \n   collect_metrics() |&gt; \n   mutate(Model = \"RAND FOR\", .before = \".metric\")\n)\n\n# A tibble: 2 × 5\n  Model      .metric     .estimator .estimate .config        \n  &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          \n1 CLASS TREE mn_log_loss binary         0.343 pre0_mod0_post0\n2 RAND FOR   mn_log_loss binary         0.326 pre0_mod0_post0\n\n# save the best overall model and workflow\nsaveRDS(rf_final_wkf, file = \"final_wkf.RDS\")\nsaveRDS(rf_final_fit, file = \"final_model.RDS\")\n\nComparing our models based on log loss (lower log loss is better), our best model of the two final models is the random forest model!"
  },
  {
    "objectID": "EDA.html",
    "href": "EDA.html",
    "title": "ST 558 Final Project - EDA",
    "section": "",
    "text": "The following data set contains over 250,000 survey from Americans, with the target variable measuring whether the respondent has diabetes of prediabetes (stored in Diabetes_binary).\nThere are 21 other variables that can be used to predict which individuals have diabetes/prediabetes. Among these are whether the individual has high blood pressure, and whether the individual has high cholesterol. Other possibly relevant health related variables are whether the individual has had a heart attack or has/had heart disease, whether the individual is a heavy drinker, whether the individual eats fruits and vegetables, whether the individual has been physically active in the last 30 days, whether the individual is/was a smoker, and the individual’s BMI. The individuals’ general health was also measured by asking them their general health on a five-level scale from “poor” to “excellent”. The individuals’ sex and age (age being grouped into age brackets) were also collected. The individual’s household income bracket was also recorded."
  },
  {
    "objectID": "EDA.html#introduction",
    "href": "EDA.html#introduction",
    "title": "ST 558 Final Project - EDA",
    "section": "",
    "text": "The following data set contains over 250,000 survey from Americans, with the target variable measuring whether the respondent has diabetes of prediabetes (stored in Diabetes_binary).\nThere are 21 other variables that can be used to predict which individuals have diabetes/prediabetes. Among these are whether the individual has high blood pressure, and whether the individual has high cholesterol. Other possibly relevant health related variables are whether the individual has had a heart attack or has/had heart disease, whether the individual is a heavy drinker, whether the individual eats fruits and vegetables, whether the individual has been physically active in the last 30 days, whether the individual is/was a smoker, and the individual’s BMI. The individuals’ general health was also measured by asking them their general health on a five-level scale from “poor” to “excellent”. The individuals’ sex and age (age being grouped into age brackets) were also collected. The individual’s household income bracket was also recorded."
  },
  {
    "objectID": "Modeling.html",
    "href": "Modeling.html",
    "title": "ST 558 Final Project - Modeling",
    "section": "",
    "text": "With our exploratory data analysis complete, we can now model our data.\nAs a recap, our data is on diabetes in the United States, with our data set including over 250,000 individuals. Our response is whether each individual has diabetes (or prediabetes) or not. We have 21 predictor variables, most of them being binary or some other form of categorical variable. These include whether in the individual has high blood pressure, has high cholesterol, the individual’s self-reported general health level, the individual income level, and more. There are also some numeric predictor variables, including individuals’ BMI, and their number of poor mental and physical health days in the last 30 days.\nSince our response variable is binary (whether or not an individual has diabetes/prediabetes), we will be using classification modelsto try to predict whether individuals have have diabetes based on our predictor variables. Specifically we will use classification trees and random forest models. Both will involve splitting the data into a training and test set and using five-fold cross validation. We will determine the best model by using log-loss as our metric. We will create these models using the tidymodels package."
  },
  {
    "objectID": "Modeling.html#introduction",
    "href": "Modeling.html#introduction",
    "title": "ST 558 Final Project - Modeling",
    "section": "",
    "text": "With our exploratory data analysis complete, we can now model our data.\nAs a recap, our data is on diabetes in the United States, with our data set including over 250,000 individuals. Our response is whether each individual has diabetes (or prediabetes) or not. We have 21 predictor variables, most of them being binary or some other form of categorical variable. These include whether in the individual has high blood pressure, has high cholesterol, the individual’s self-reported general health level, the individual income level, and more. There are also some numeric predictor variables, including individuals’ BMI, and their number of poor mental and physical health days in the last 30 days.\nSince our response variable is binary (whether or not an individual has diabetes/prediabetes), we will be using classification modelsto try to predict whether individuals have have diabetes based on our predictor variables. Specifically we will use classification trees and random forest models. Both will involve splitting the data into a training and test set and using five-fold cross validation. We will determine the best model by using log-loss as our metric. We will create these models using the tidymodels package."
  },
  {
    "objectID": "Modeling.html#classification-trees",
    "href": "Modeling.html#classification-trees",
    "title": "ST 558 Final Project - Modeling",
    "section": "Classification Trees",
    "text": "Classification Trees\nA classification tree is a type of model used to predict a categorical response variable. They are done by splitting the prediction space up into regions, within each region a prediction will be made (in this: No diabetes or diabetes). We start by splitting the data into a training and test set, with our model being trained on the training set, and our test set being used to test how it performs on new data. We will use a 70/30 train/test split here. Within our training set, we will use five-fold cross validation, where our training data is split into five sections, and over five iterations each is used as testing data once, so we can compare models within our training data. Our classification tree will break up into regions based on our chosen predictor variables, and after splitting into regions, it will predict whether our response variable falls into ‘No Diabetes’ or ‘Prediabetes/Diabetes’ based on what is the most common response in that region.\n\n# set the engine for our classification tree model\nclass_tree_mod &lt;- decision_tree(min_n = 100,\n                          cost_complexity = tune()\n                          ) |&gt;\n  set_engine(\"rpart\") |&gt;\n  set_mode(\"classification\")\n\n# create the workflow for our classification tree\nclass_tree_wkf &lt;- workflow() |&gt;\n  add_recipe(recipe) |&gt;\n  add_model(class_tree_mod)\n\nclass_tree_wkf\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: decision_tree()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n1 Recipe Step\n\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\nDecision Tree Model Specification (classification)\n\nMain Arguments:\n  cost_complexity = tune()\n  min_n = 100\n\nComputational engine: rpart \n\ntree_grid &lt;- grid_regular(cost_complexity(),\n                          levels = 10)\n\n# tune our classification tree with 5 fold CV (using default levels)\nclass_tree_fits &lt;- class_tree_wkf |&gt; \n  tune_grid(resamples = diabetes_5_fold_cv,\n            metrics = metric_set(mn_log_loss),\n            grid = tree_grid)\n\n\nclass_tree_fits\n\n# Tuning results\n# 5-fold cross-validation \n# A tibble: 5 × 4\n  splits                 id    .metrics          .notes          \n  &lt;list&gt;                 &lt;chr&gt; &lt;list&gt;            &lt;list&gt;          \n1 &lt;split [142060/35516]&gt; Fold1 &lt;tibble [10 × 5]&gt; &lt;tibble [0 × 4]&gt;\n2 &lt;split [142061/35515]&gt; Fold2 &lt;tibble [10 × 5]&gt; &lt;tibble [0 × 4]&gt;\n3 &lt;split [142061/35515]&gt; Fold3 &lt;tibble [10 × 5]&gt; &lt;tibble [0 × 4]&gt;\n4 &lt;split [142061/35515]&gt; Fold4 &lt;tibble [10 × 5]&gt; &lt;tibble [0 × 4]&gt;\n5 &lt;split [142061/35515]&gt; Fold5 &lt;tibble [10 × 5]&gt; &lt;tibble [0 × 4]&gt;\n\n# view the metrics of our tree with different tunings\nclass_tree_fits |&gt; \n  collect_metrics()\n\n# A tibble: 10 × 7\n   cost_complexity .metric     .estimator  mean     n  std_err .config         \n             &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;           \n 1    0.0000000001 mn_log_loss binary     0.342     5 0.00157  pre0_mod01_post0\n 2    0.000000001  mn_log_loss binary     0.342     5 0.00157  pre0_mod02_post0\n 3    0.00000001   mn_log_loss binary     0.342     5 0.00157  pre0_mod03_post0\n 4    0.0000001    mn_log_loss binary     0.342     5 0.00157  pre0_mod04_post0\n 5    0.000001     mn_log_loss binary     0.342     5 0.00157  pre0_mod05_post0\n 6    0.00001      mn_log_loss binary     0.342     5 0.00158  pre0_mod06_post0\n 7    0.0001       mn_log_loss binary     0.350     5 0.000824 pre0_mod07_post0\n 8    0.001        mn_log_loss binary     0.358     5 0.00241  pre0_mod08_post0\n 9    0.01         mn_log_loss binary     0.404     5 0.00201  pre0_mod09_post0\n10    0.1          mn_log_loss binary     0.404     5 0.00201  pre0_mod10_post0\n\n# sort the trees by how they perform in terms of log loss\nclass_tree_fits |&gt;\n  collect_metrics() |&gt;\n  filter(.metric == \"mn_log_loss\") |&gt;\n  arrange(mean)\n\n# A tibble: 10 × 7\n   cost_complexity .metric     .estimator  mean     n  std_err .config         \n             &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;           \n 1    0.0000000001 mn_log_loss binary     0.342     5 0.00157  pre0_mod01_post0\n 2    0.000000001  mn_log_loss binary     0.342     5 0.00157  pre0_mod02_post0\n 3    0.00000001   mn_log_loss binary     0.342     5 0.00157  pre0_mod03_post0\n 4    0.0000001    mn_log_loss binary     0.342     5 0.00157  pre0_mod04_post0\n 5    0.000001     mn_log_loss binary     0.342     5 0.00157  pre0_mod05_post0\n 6    0.00001      mn_log_loss binary     0.342     5 0.00158  pre0_mod06_post0\n 7    0.0001       mn_log_loss binary     0.350     5 0.000824 pre0_mod07_post0\n 8    0.001        mn_log_loss binary     0.358     5 0.00241  pre0_mod08_post0\n 9    0.01         mn_log_loss binary     0.404     5 0.00201  pre0_mod09_post0\n10    0.1          mn_log_loss binary     0.404     5 0.00201  pre0_mod10_post0\n\n# select the best tree in terms of log loss\nclass_tree_best_params &lt;- select_best(class_tree_fits, metric = \"mn_log_loss\")\n\n# our best classification tree\nclass_tree_best_params\n\n# A tibble: 1 × 2\n  cost_complexity .config         \n            &lt;dbl&gt; &lt;chr&gt;           \n1    0.0000000001 pre0_mod01_post0\n\n# finalize our workflow and fit our best classification tree to the training data\nclass_tree_final_wkf &lt;- class_tree_wkf |&gt;\n  finalize_workflow(class_tree_best_params)\n\nclass_tree_final_fit &lt;- class_tree_final_wkf |&gt;\n  last_fit(diabetes_split, metrics = metric_set(mn_log_loss))\n\nclass_tree_final_fit\n\n# Resampling results\n# Manual resampling \n# A tibble: 1 × 6\n  splits                 id            .metrics .notes   .predictions .workflow \n  &lt;list&gt;                 &lt;chr&gt;         &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    \n1 &lt;split [177576/76104]&gt; train/test s… &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;\n\n\nWe now have our best classification tree model!"
  },
  {
    "objectID": "Modeling.html#creating-our-recipe",
    "href": "Modeling.html#creating-our-recipe",
    "title": "ST 558 Final Project - Modeling",
    "section": "Creating Our Recipe",
    "text": "Creating Our Recipe\nWhen using tidymodels, we must first create our recipe recipe and our workflow. Our recipe includes the predictor variables that will be included in our model. Once we have create our recipes, we can then fit these recipes to different types of models by combining them with a model engine to create our workflows.\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.4.1 ──\n✔ broom        1.0.9     ✔ rsample      1.3.1\n✔ dials        1.4.2     ✔ tailor       0.1.0\n✔ infer        1.0.9     ✔ tune         2.0.1\n✔ modeldata    1.5.1     ✔ workflows    1.3.0\n✔ parsnip      1.3.3     ✔ workflowsets 1.1.1\n✔ recipes      1.3.1     ✔ yardstick    1.3.2\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\nlibrary(rpart)\n\n\nAttaching package: 'rpart'\n\nThe following object is masked from 'package:dials':\n\n    prune\n\nlibrary(ranger)\nlibrary(baguette)\n\n# read in data on diabetes\ndiabetes_data &lt;- read_csv(\"diabetes_binary_health_indicators_BRFSS2015.csv\")\n\nRows: 253680 Columns: 22\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (22): Diabetes_binary, HighBP, HighChol, CholCheck, BMI, Smoker, Stroke,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n# convert columns with binary variables to factors and change the names of values\ndiabetes_data &lt;- diabetes_data |&gt; \n  mutate(\n    Diabetes_binary = as.factor(Diabetes_binary), \n    HighBP = as.factor(HighBP), \n    HighChol = as.factor(HighChol), \n    CholCheck = as.factor(CholCheck), \n    Smoker = as.factor(Smoker), \n    Stroke = as.factor(Stroke), \n    HeartDiseaseorAttack = as.factor(HeartDiseaseorAttack), \n    PhysActivity = as.factor(PhysActivity), \n    Fruits = as.factor(Fruits), \n    Veggies = as.factor(Veggies), \n    HvyAlcoholConsump = as.factor(HvyAlcoholConsump), \n    AnyHealthcare = as.factor(AnyHealthcare), \n    NoDocbcCost = as.factor(NoDocbcCost), \n    GenHlth = as.factor(GenHlth), \n    DiffWalk = as.factor(DiffWalk), \n    Sex = as.factor(Sex), \n    Age = as.factor(Age), \n    Education = as.factor(Education), \n    Income = as.factor(Income)\n  )\n\n\n# change level names of factors\nlevels(diabetes_data$Diabetes_binary) &lt;- list(\"No Diabetes\" = \"0\", \"Prediabetes/Diabetes\" = \"1\")\n\nlevels(diabetes_data$HighBP) &lt;- list(\"No High Blood Pressue\" = \"0\", \"High Blood Pressure\" = \"1\")\n\nlevels(diabetes_data$HighChol) &lt;- list(\"No High Cholesterol\" = \"0\", \"High Cholesterol\" = \"1\")\n\nlevels(diabetes_data$CholCheck) &lt;- list(\"No Chol. check in last 5 years\" = \"0\", \"Chol. check in last 5 years\" = \"1\")\n\nlevels(diabetes_data$Smoker) &lt;- list(\"Non-Smoker\" = \"0\", \"Smoker\" = \"1\")\n\nlevels(diabetes_data$Stroke) &lt;- list(\"Never had strok\" = \"0\", \"Had stroke\" = \"1\")\n\nlevels(diabetes_data$HeartDiseaseorAttack) &lt;- list(\"Never had heart disease/attack\" = \"0\", \"Had heart disease/attack\" = \"1\")\n\nlevels(diabetes_data$PhysActivity) &lt;- list(\"No physical activity in last 30 days\" = \"0\", \"Physical activity in last 30 days\" = \"1\")\n\nlevels(diabetes_data$Fruits) &lt;- list(\"Doesn't eat fruit\" = \"0\", \"Eats fruit\" = \"1\")\n\nlevels(diabetes_data$Veggies) &lt;- list(\"Doesn't eat veggies\" = \"0\", \"Eats veggies\" = \"1\")\n\nlevels(diabetes_data$HvyAlcoholConsump) &lt;- list(\"Not heavy drinker\" = \"0\", \"Heavy drinker\" = \"1\")\n\nlevels(diabetes_data$AnyHealthcare) &lt;- list(\"No healthcare\" = \"0\", \"Healthcare\" = \"1\")\n\nlevels(diabetes_data$NoDocbcCost) &lt;- list(\"Can't afford doctor\" = \"0\", \"Can afford doctor\" = \"1\")\n\nlevels(diabetes_data$GenHlth) &lt;- list(\"Excellent\" = \"1\", \"Very Good\" = \"2\", \"Good\" = \"3\", \"Fair\" = \"4\", \"Poor\" = \"5\")\n\nlevels(diabetes_data$DiffWalk) &lt;- list(\"No difficulty walking\" = \"0\", \"Difficulty walking\" = \"1\")\n\nlevels(diabetes_data$Sex) &lt;- list(\"Female\" = \"0\", \"Male\" = \"1\")\n\nlevels(diabetes_data$Age) &lt;- list(\"18-24\" = \"1\", \"25-29\" = \"2\", \"30-34\" = \"3\", \"35-39\" = \"4\", \"40-44\" = \"5\", \"45-49\" = \"6\", \"50-54\" = \"7\", \"55-59\" = \"8\", \"60-64\" = \"9\", \"65-69\" = \"10\", \"70-74\" = \"11\", \"75-79\" = \"12\", \"80+\" = \"13\")\n\nlevels(diabetes_data$Education) &lt;- list(\"No school/kindergarten\" = \"1\", \"Elementary\" = \"2\", \"Some high school\" = \"3\", \"High school graduate\" = \"4\", \"Some college\" = \"5\", \"College graduate\" = \"6\")\n\nlevels(diabetes_data$Income) &lt;- list(\"&lt; $10,000\" = \"1\", \"$10,000-$15,000\" = \"2\", \"$15,000-$20,000\" = \"3\", \"$20,000-$25,000\" = \"4\", \"$25,000-$35,000\" = \"5\", \"$35,000-$50,000\" = \"6\", \"$50,000-$75,000\" = \"7\", \"$75,000+\" = \"8\")\n\n\n# set seed so the results are replicable\nset.seed(2824)\n\n# split the data into a 70/20 training/test split\ndiabetes_split &lt;- initial_split(diabetes_data, prop = 0.70)\n\n# save the 70% split as training\ndiabetes_train &lt;- training(diabetes_split)\n\n# save the 30% split as testing\ndiabetes_test &lt;- testing(diabetes_split)\n\n# view the training and testing sets\ndiabetes_train\n\n# A tibble: 177,576 × 22\n   Diabetes_binary      HighBP            HighChol CholCheck   BMI Smoker Stroke\n   &lt;fct&gt;                &lt;fct&gt;             &lt;fct&gt;    &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt; \n 1 No Diabetes          High Blood Press… High Ch… Chol. ch…    27 Non-S… Never…\n 2 No Diabetes          No High Blood Pr… No High… Chol. ch…    27 Smoker Never…\n 3 No Diabetes          No High Blood Pr… No High… Chol. ch…    31 Smoker Never…\n 4 Prediabetes/Diabetes High Blood Press… High Ch… Chol. ch…    34 Smoker Never…\n 5 Prediabetes/Diabetes No High Blood Pr… High Ch… Chol. ch…    28 Smoker Never…\n 6 No Diabetes          No High Blood Pr… No High… Chol. ch…    27 Non-S… Never…\n 7 No Diabetes          High Blood Press… No High… Chol. ch…    20 Non-S… Never…\n 8 No Diabetes          No High Blood Pr… No High… Chol. ch…    27 Smoker Never…\n 9 No Diabetes          High Blood Press… No High… Chol. ch…    38 Non-S… Never…\n10 No Diabetes          No High Blood Pr… No High… Chol. ch…    26 Non-S… Never…\n# ℹ 177,566 more rows\n# ℹ 15 more variables: HeartDiseaseorAttack &lt;fct&gt;, PhysActivity &lt;fct&gt;,\n#   Fruits &lt;fct&gt;, Veggies &lt;fct&gt;, HvyAlcoholConsump &lt;fct&gt;, AnyHealthcare &lt;fct&gt;,\n#   NoDocbcCost &lt;fct&gt;, GenHlth &lt;fct&gt;, MentHlth &lt;dbl&gt;, PhysHlth &lt;dbl&gt;,\n#   DiffWalk &lt;fct&gt;, Sex &lt;fct&gt;, Age &lt;fct&gt;, Education &lt;fct&gt;, Income &lt;fct&gt;\n\ndiabetes_test\n\n# A tibble: 76,104 × 22\n   Diabetes_binary      HighBP            HighChol CholCheck   BMI Smoker Stroke\n   &lt;fct&gt;                &lt;fct&gt;             &lt;fct&gt;    &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt; \n 1 No Diabetes          High Blood Press… No High… Chol. ch…    30 Smoker Never…\n 2 Prediabetes/Diabetes High Blood Press… High Ch… Chol. ch…    30 Smoker Never…\n 3 Prediabetes/Diabetes No High Blood Pr… No High… Chol. ch…    25 Smoker Never…\n 4 No Diabetes          No High Blood Pr… High Ch… Chol. ch…    33 Smoker Had s…\n 5 No Diabetes          No High Blood Pr… No High… No Chol.…    23 Non-S… Never…\n 6 No Diabetes          No High Blood Pr… High Ch… Chol. ch…    28 Non-S… Never…\n 7 No Diabetes          High Blood Press… High Ch… Chol. ch…    22 Non-S… Had s…\n 8 No Diabetes          High Blood Press… High Ch… Chol. ch…    38 Smoker Never…\n 9 No Diabetes          High Blood Press… No High… Chol. ch…    33 Smoker Never…\n10 Prediabetes/Diabetes High Blood Press… High Ch… Chol. ch…    24 Smoker Never…\n# ℹ 76,094 more rows\n# ℹ 15 more variables: HeartDiseaseorAttack &lt;fct&gt;, PhysActivity &lt;fct&gt;,\n#   Fruits &lt;fct&gt;, Veggies &lt;fct&gt;, HvyAlcoholConsump &lt;fct&gt;, AnyHealthcare &lt;fct&gt;,\n#   NoDocbcCost &lt;fct&gt;, GenHlth &lt;fct&gt;, MentHlth &lt;dbl&gt;, PhysHlth &lt;dbl&gt;,\n#   DiffWalk &lt;fct&gt;, Sex &lt;fct&gt;, Age &lt;fct&gt;, Education &lt;fct&gt;, Income &lt;fct&gt;\n\n# want to create a 5 fold CV split on our training data\ndiabetes_5_fold_cv &lt;- vfold_cv(diabetes_train, 5)\n\n# view the 5 fold CV\ndiabetes_5_fold_cv\n\n#  5-fold cross-validation \n# A tibble: 5 × 2\n  splits                 id   \n  &lt;list&gt;                 &lt;chr&gt;\n1 &lt;split [142060/35516]&gt; Fold1\n2 &lt;split [142061/35515]&gt; Fold2\n3 &lt;split [142061/35515]&gt; Fold3\n4 &lt;split [142061/35515]&gt; Fold4\n5 &lt;split [142061/35515]&gt; Fold5\n\n\n\nSetting up the recipe\n\n# create a recipe, including all predictor variables plus some quadratic terms\nrecipe &lt;- recipe(Diabetes_binary ~ HighBP + HighChol + Veggies + GenHlth + DiffWalk + AnyHealthcare + BMI, data = diabetes_train) |&gt; \n  step_dummy(all_factor(), -Diabetes_binary)\n\nrecipe \n\n\n\n\n── Recipe ──────────────────────────────────────────────────────────────────────\n\n\n\n\n\n── Inputs \n\n\nNumber of variables by role\n\n\noutcome:   1\npredictor: 7\n\n\n\n\n\n── Operations \n\n\n• Dummy variables from: all_factor() -Diabetes_binary\n\n# view results\nrecipe |&gt; \n  prep(training = diabetes_train) |&gt; \n  bake(diabetes_train)\n\n# A tibble: 177,576 × 11\n     BMI Diabetes_binary      HighBP_High.Blood.Pressure HighChol_High.Cholest…¹\n   &lt;dbl&gt; &lt;fct&gt;                                     &lt;dbl&gt;                   &lt;dbl&gt;\n 1    27 No Diabetes                                   1                       1\n 2    27 No Diabetes                                   0                       0\n 3    31 No Diabetes                                   0                       0\n 4    34 Prediabetes/Diabetes                          1                       1\n 5    28 Prediabetes/Diabetes                          0                       1\n 6    27 No Diabetes                                   0                       0\n 7    20 No Diabetes                                   1                       0\n 8    27 No Diabetes                                   0                       0\n 9    38 No Diabetes                                   1                       0\n10    26 No Diabetes                                   0                       0\n# ℹ 177,566 more rows\n# ℹ abbreviated name: ¹​HighChol_High.Cholesterol\n# ℹ 7 more variables: Veggies_Eats.veggies &lt;dbl&gt;, GenHlth_Very.Good &lt;dbl&gt;,\n#   GenHlth_Good &lt;dbl&gt;, GenHlth_Fair &lt;dbl&gt;, GenHlth_Poor &lt;dbl&gt;,\n#   DiffWalk_Difficulty.walking &lt;dbl&gt;, AnyHealthcare_Healthcare &lt;dbl&gt;\n\n# names of variables in the recipe\nrecipe  |&gt; \n  prep(training = diabetes_train) |&gt; \n  bake(diabetes_train) |&gt; \n  names()\n\n [1] \"BMI\"                         \"Diabetes_binary\"            \n [3] \"HighBP_High.Blood.Pressure\"  \"HighChol_High.Cholesterol\"  \n [5] \"Veggies_Eats.veggies\"        \"GenHlth_Very.Good\"          \n [7] \"GenHlth_Good\"                \"GenHlth_Fair\"               \n [9] \"GenHlth_Poor\"                \"DiffWalk_Difficulty.walking\"\n[11] \"AnyHealthcare_Healthcare\"   \n\n\nOur recipe includes high blood pressure, high cholesterol, whether the individual eats vegetables, self-reported general health, difficulty walking, whether the individual has healthcare and BMI as predictor variables. All of the categorical predictors (which is all of them except BMI) were converted into dummy variables. We took in seven predictors, and have 10 predictor variables in our recipe including dummies."
  }
]